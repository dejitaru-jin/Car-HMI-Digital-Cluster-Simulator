<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 750">
  <!-- Background -->
  <rect width="900" height="750" fill="#f8f8f8" rx="10" ry="10"/>
  
  <!-- Title -->
  <text x="450" y="40" font-family="Arial" font-size="24" text-anchor="middle" fill="#333333" font-weight="bold">Car HMI Emulator - Sequence Diagram</text>
  
  <!-- Participant boxes -->
  <rect x="50" y="80" width="120" height="60" fill="#d5e8d4" stroke="#82b366" stroke-width="2" rx="5" ry="5"/>
  <text x="110" y="115" font-family="Arial" font-size="14" text-anchor="middle" fill="#333333">Main</text>
  <text x="110" y="135" font-family="Arial" font-size="12" text-anchor="middle" fill="#333333">Application</text>
  
  <rect x="190" y="80" width="120" height="60" fill="#dae8fc" stroke="#6c8ebf" stroke-width="2" rx="5" ry="5"/>
  <text x="250" y="115" font-family="Arial" font-size="14" text-anchor="middle" fill="#333333">Event</text>
  <text x="250" y="135" font-family="Arial" font-size="12" text-anchor="middle" fill="#333333">Handler</text>
  
  <rect x="330" y="80" width="120" height="60" fill="#ffe6cc" stroke="#d79b00" stroke-width="2" rx="5" ry="5"/>
  <text x="390" y="115" font-family="Arial" font-size="14" text-anchor="middle" fill="#333333">Component</text>
  <text x="390" y="135" font-family="Arial" font-size="12" text-anchor="middle" fill="#333333">Manager</text>
  
  <rect x="470" y="80" width="120" height="60" fill="#fff2cc" stroke="#d6b656" stroke-width="2" rx="5" ry="5"/>
  <text x="530" y="115" font-family="Arial" font-size="14" text-anchor="middle" fill="#333333">Component</text>
  
  <rect x="610" y="80" width="120" height="60" fill="#f8cecc" stroke="#b85450" stroke-width="2" rx="5" ry="5"/>
  <text x="670" y="115" font-family="Arial" font-size="14" text-anchor="middle" fill="#333333">Renderer</text>
  
  <rect x="750" y="80" width="120" height="60" fill="#e1d5e7" stroke="#9673a6" stroke-width="2" rx="5" ry="5"/>
  <text x="810" y="115" font-family="Arial" font-size="14" text-anchor="middle" fill="#333333">Socket</text>
  <text x="810" y="135" font-family="Arial" font-size="12" text-anchor="middle" fill="#333333">Interface</text>
  
  <!-- Lifelines -->
  <line x1="110" y1="140" x2="110" y2="700" stroke="#82b366" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="250" y1="140" x2="250" y2="700" stroke="#6c8ebf" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="390" y1="140" x2="390" y2="700" stroke="#d79b00" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="530" y1="140" x2="530" y2="700" stroke="#d6b656" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="670" y1="140" x2="670" y2="700" stroke="#b85450" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="810" y1="140" x2="810" y2="700" stroke="#9673a6" stroke-width="2" stroke-dasharray="5,5"/>
  
  <!-- Initialization -->
  <rect x="100" y="160" width="20" height="100" fill="#d5e8d4" stroke="#82b366" stroke-width="2"/>
  
  <line x1="120" y1="170" x2="380" y2="170" stroke="#333333" stroke-width="2"/>
  <polygon points="380,170 370,165 370,175" fill="#333333"/>
  <text x="250" y="160" font-family="Arial" font-size="12" fill="#333333">Initialize Components</text>
  
  <rect x="380" y="170" width="20" height="80" fill="#ffe6cc" stroke="#d79b00" stroke-width="2"/>
  
  <line x1="400" y1="180" x2="520" y2="180" stroke="#333333" stroke-width="2"/>
  <polygon points="520,180 510,175 510,185" fill="#333333"/>
  <text x="460" y="170" font-family="Arial" font-size="12" fill="#333333">Create Component Instances</text>
  
  <rect x="520" y="180" width="20" height="50" fill="#fff2cc" stroke="#d6b656" stroke-width="2"/>
  
  <line x1="520" y1="230" x2="400" y2="230" stroke="#333333" stroke-width="2" stroke-dasharray="5,5"/>
  <polygon points="400,230 410,225 410,235" fill="#333333"/>
  <text x="460" y="220" font-family="Arial" font-size="12" fill="#333333">Components Ready</text>
  
  <line x1="520" y1="250" x2="800" y2="250" stroke="#333333" stroke-width="2"/>
  <polygon points="800,250 790,245 790,255" fill="#333333"/>
  <text x="660" y="240" font-family="Arial" font-size="12" fill="#333333">Start Socket Listeners (if needed)</text>
  
  <rect x="800" y="250" width="20" height="30" fill="#e1d5e7" stroke="#9673a6" stroke-width="2"/>
  
  <line x1="380" y1="250" x2="120" y2="250" stroke="#333333" stroke-width="2" stroke-dasharray="5,5"/>
  <polygon points="120,250 130,245 130,255" fill="#333333"/>
  <text x="250" y="240" font-family="Arial" font-size="12" fill="#333333">Components Initialized</text>
  
  <!-- Divider -->
  <line x1="50" y1="280" x2="850" y2="280" stroke="#999999" stroke-width="1" stroke-dasharray="2,2"/>
  <text x="450" y="300" font-family="Arial" font-size="14" text-anchor="middle" fill="#666666" font-style="italic">Main Loop</text>
  
  <!-- Loop frame -->
  <rect x="40" y="320" width="820" height="300" fill="none" stroke="#999999" stroke-width="2" rx="10" ry="10"/>
  <text x="100" y="340" font-family="Arial" font-size="14" fill="#666666" font-style="italic">loop</text>
  <text x="160" y="340" font-family="Arial" font-size="14" fill="#666666">Every Frame</text>
  
  <!-- Main Loop -->
  <rect x="100" y="350" width="20" height="250" fill="#d5e8d4" stroke="#82b366" stroke-width="2"/>
  
  <line x1="120" y1="360" x2="240" y2="360" stroke="#333333" stroke-width="2"/>
  <polygon points="240,360 230,355 230,365" fill="#333333"/>
  <text x="180" y="350" font-family="Arial" font-size="12" fill="#333333">Process Events</text>
  
  <rect x="240" y="360" width="20" height="30" fill="#dae8fc" stroke="#6c8ebf" stroke-width="2"/>
  
  <line x1="240" y1="390" x2="120" y2="390" stroke="#333333" stroke-width="2" stroke-dasharray="5,5"/>
  <polygon points="120,390 130,385 130,395" fill="#333333"/>
  <text x="180" y="380" font-family="Arial" font-size="12" fill="#333333">Event Results</text>
  
  <!-- Alt frame for update source -->
  <rect x="60" y="410" width="780" height="120" fill="none" stroke="#999999" stroke-width="2" rx="5" ry="5"/>
  <text x="80" y="430" font-family="Arial" font-size="14" fill="#666666" font-style="italic">alt</text>
  <line x1="60" y1="440" x2="840" y2="440" stroke="#999999" stroke-width="1" stroke-dasharray="2,2"/>
  <text x="180" y="430" font-family="Arial" font-size="12" fill="#666666">If Simulation Mode</text>
  <text x="180" y="470" font-family="Arial" font-size="12" fill="#666666">If External Data</text>
  
  <!-- Simulation Update -->
  <line x1="120" y1="420" x2="520" y2="420" stroke="#333333" stroke-width="2"/>
  <polygon points="520,420 510,415 510,425" fill="#333333"/>
  <text x="320" y="410" font-family="Arial" font-size="12" fill="#333333">Update Component (Simulated Data)</text>
  
  <rect x="520" y="420" width="20" height="20" fill="#fff2cc" stroke="#d6b656" stroke-width="2"/>
  
  <!-- External Data Update -->
  <rect x="800" y="450" width="20" height="40" fill="#e1d5e7" stroke="#9673a6" stroke-width="2"/>
  
  <line x1="800" y1="460" x2="520" y2="460" stroke="#333333" stroke-width="2"/>
  <polygon points="520,460 530,455 530,465" fill="#333333"/>
  <text x="660" y="450" font-family="Arial" font-size="12" fill="#333333">Receive Data</text>
  
  <rect x="520" y="460" width="20" height="40" fill="#fff2cc" stroke="#d6b656" stroke-width="2"/>
  
  <line x1="530" y1="480" x2="550" y2="480" stroke="#333333" stroke-width="2"/>
  <polygon points="550,480 540,475 540,485" fill="#333333"/>
  <text x="580" y="470" font-family="Arial" font-size="12" fill="#333333">Process Data</text>
  <line x1="550" y1="480" x2="550" y2="490" stroke="#333333" stroke-width="2"/>
  <line x1="550" y1="490" x2="530" y2="490" stroke="#333333" stroke-width="2"/>
  <polygon points="530,490 540,485 540,495" fill="#333333"/>
  
  <!-- Rendering -->
  <line x1="120" y1="540" x2="660" y2="540" stroke="#333333" stroke-width="2"/>
  <polygon points="660,540 650,535 650,545" fill="#333333"/>
  <text x="390" y="530" font-family="Arial" font-size="12" fill="#333333">Prepare Render</text>
  
  <rect x="660" y="540" width="20" height="80" fill="#f8cecc" stroke="#b85450" stroke-width="2"/>
  
  <line x1="680" y1="550" x2="520" y2="550" stroke="#333333" stroke-width="2"/>
  <polygon points="520,550 530,545 530,555" fill="#333333"/>
  <text x="600" y="540" font-family="Arial" font-size="12" fill="#333333">Request Draw</text>
  
  <rect x="520" y="550" width="20" height="50" fill="#fff2cc" stroke="#d6b656" stroke-width="2"/>
  
  <line x1="530" y1="560" x2="550" y2="560" stroke="#333333" stroke-width="2"/>
  <polygon points="550,560 540,555 540,565" fill="#333333"/>
  <text x="580" y="550" font-family="Arial" font-size="12" fill="#333333">Render to Subsurface</text>
  <line x1="550" y1="560" x2="550" y2="570" stroke="#333333" stroke-width="2"/>
  <line x1="550" y1="570" x2="530" y2="570" stroke="#333333" stroke-width="2"/>
  <polygon points="530,570 540,565 540,575" fill="#333333"/>
  
  <line x1="520" y1="600" x2="680" y2="600" stroke="#333333" stroke-width="2" stroke-dasharray="5,5"/>
  <polygon points="680,600 670,595 670,605" fill="#333333"/>
  <text x="600" y="590" font-family="Arial" font-size="12" fill="#333333">Draw Complete</text>
  
  <line x1="660" y1="620" x2="120" y2="620" stroke="#333333" stroke-width="2" stroke-dasharray="5,5"/>
  <polygon points="120,620 130,615 130,625" fill="#333333"/>
  <text x="390" y="610" font-family="Arial" font-size="12" fill="#333333">Rendering Complete</text>
  
  <line x1="110" y1="630" x2="130" y2="630" stroke="#333333" stroke-width="2"/>
  <polygon points="130,630 120,625 120,635" fill="#333333"/>
  <text x="160" y="620" font-family="Arial" font-size="12" fill="#333333">Update Display</text>
  <line x1="130" y1="630" x2="130" y2="640" stroke="#333333" stroke-width="2"/>
  <line x1="130" y1="640" x2="110" y2="640" stroke="#333333" stroke-width="2"/>
  <polygon points="110,640 120,635 120,645" fill="#333333"/>
  
  <!-- Divider -->
  <line x1="50" y1="650" x2="850" y2="650" stroke="#999999" stroke-width="1" stroke-dasharray="2,2"/>
  <text x="450" y="670" font-family="Arial" font-size="14" text-anchor="middle" fill="#666666" font-style="italic">Shutdown</text>
  
  <!-- Shutdown -->
  <rect x="100" y="680" width="20" height="30" fill="#d5e8d4" stroke="#82b366" stroke-width="2"/>
  
  <line x1="120" y1="690" x2="800" y2="690" stroke="#333333" stroke-width="2"/>
  <polygon points="800,690 790,685 790,695" fill="#333333"/>
  <text x="460" y="680" font-family="Arial" font-size="12" fill="#333333">Close Connections</text>
  
  <rect x="800" y="690" width="20" height="10" fill="#e1d5e7" stroke="#9673a6" stroke-width="2"/>
  
  <line x1="120" y1="710" x2="380" y2="710" stroke="#333333" stroke-width="2"/>
  <polygon points="380,710 370,705 370,715" fill="#333333"/>
  <text x="250" y="700" font-family="Arial" font-size="12" fill="#333333">Cleanup Resources</text>
  
  <rect x="380" y="710" width="20" height="10" fill="#ffe6cc" stroke="#d79b00" stroke-width="2"/>
</svg>